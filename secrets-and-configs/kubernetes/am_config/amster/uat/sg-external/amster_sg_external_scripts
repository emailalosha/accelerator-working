create Scripts --realm sg-external --id 3f57f327-1e4d-488c-9ad1-5f258c182747 --body '{"name":"Check soft token mock","description":"null","script":"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwp2YXIgdXNlcnMgPSBbJ2lhbXRlc3R1c2VyMDAxJywgJ2lhbXRlc3R1c2VyMDAyJywgJ2lhbXRlc3R1c2VyMDAzJwogICAgICAgICAgICAgLCAneHVucXUwMDEnLCAneHVucXUwMDInLCAneHVucXUwMDMnLCAneHVucXUwMDQnLCAneHVucXUwMDUnCiAgICAgICAgICAgICAsICdmdXNoZW5nMDAzJywgJ0Z1c2hlbmcwMDMnLCAneGlueXVhbjAwMiddOwp2YXIgdXNlcm5hbWUgPSBzaGFyZWRTdGF0ZS5nZXQoInVzZXJuYW1lIik7CmlmICh1c2Vycy5pbmNsdWRlcyh1c2VybmFtZSkpIHsKICBvdXRjb21lID0gInRydWUiOwp9IGVsc2UgewogIG91dGNvbWUgPSAiZmFsc2UiOwp9","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id d5580cf0-b388-4adb-862e-58a985303bfe --body '{"name":"CIAM Activate Soft Token Check","description":"CIAM Activate Soft Token Check","script":"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwp2YXIgYWN0aXZhdGlvbkVuYWJsZWQgPSBzaGFyZWRTdGF0ZS5nZXQoImFjdGl2YXRpb25FbmFibGVkIik7CmlmIChhY3RpdmF0aW9uRW5hYmxlZCA9PSAndHJ1ZScpIHsKCW91dGNvbWUgPSAidHJ1ZSI7Cn0gZWxzZSB7CiAgb3V0Y29tZSA9ICJmYWxzZSI7Cn0=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id f582715d-e9e8-411b-928e-c88f603aa5a6 --body '{"name":"CIAM Created PinCode Check","description":"null","script":"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKb3V0Y29tZSA9IHNoYXJlZFN0YXRlLmdldCgiY3JlYXRlZFBpbkNvZGUiKTs=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id b18e42a4-ec5c-4e10-af42-652f61d50a12 --body '{"name":"CIAM Send OTP Check","description":"null","script":"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwp2YXIgb3RwRW5hYmxlZCA9IHNoYXJlZFN0YXRlLmdldCgib3RwRW5hYmxlZCIpOwppZiAob3RwRW5hYmxlZCA9PSAndHJ1ZScpIHsKCW91dGNvbWUgPSAidHJ1ZSI7Cn0gZWxzZSB7CiAgb3V0Y29tZSA9ICJmYWxzZSI7Cn0=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id 2e523b75-8156-4fc1-9f84-988d11bf1a0f --body '{"name":"OTP Lockout script","description":"null","script":"LyoKICAtIERhdGEgbWFkZSBhdmFpbGFibGUgYnkgbm9kZXMgdGhhdCBoYXZlIGFscmVhZHkgZXhlY3V0ZWQgYXJlIGF2YWlsYWJsZSBpbiB0aGUgc2hhcmVkU3RhdGUgdmFyaWFibGUuCiAgLSBUaGUgc2NyaXB0IHNob3VsZCBzZXQgb3V0Y29tZSB0byBlaXRoZXIgInRydWUiIG9yICJmYWxzZSIuCiAqLwoKb3V0Y29tZSA9ICJ0cnVlIjs=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
update Scripts --realm sg-external --id d22f9a0c-426a-4466-b95e-d0f125b0d5fa --body '{"name":"OAuth2 Access Token Modification Script","description":"Default global script for OAuth2 Access Token Modification","script":"LyoKICogQ29weXJpZ2h0IDIwMTkgRm9yZ2VSb2NrIEFTLiBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFVzZSBvZiB0aGlzIGNvZGUgcmVxdWlyZXMgYSBjb21tZXJjaWFsIHNvZnR3YXJlIGxpY2Vuc2Ugd2l0aCBGb3JnZVJvY2sgQVMuCiAqIG9yIHdpdGggb25lIG9mIGl0cyBhZmZpbGlhdGVzLiBBbGwgdXNlIHNoYWxsIGJlIGV4Y2x1c2l2ZWx5IHN1YmplY3QKICogdG8gc3VjaCBsaWNlbnNlIGJldHdlZW4gdGhlIGxpY2Vuc2VlIGFuZCBGb3JnZVJvY2sgQVMuCiAqLwoKaW1wb3J0IG9yZy5mb3JnZXJvY2suaHR0cC5wcm90b2NvbC5SZXF1ZXN0CmltcG9ydCBvcmcuZm9yZ2Vyb2NrLmh0dHAucHJvdG9jb2wuUmVzcG9uc2UKCmltcG9ydCBjb20uaXBsYW5ldC5zc28uU1NPRXhjZXB0aW9uCgppbXBvcnQgZ3Jvb3Z5Lmpzb24uSnNvblNsdXJwZXIKCmFjY2Vzc1Rva2VuLnNldEZpZWxkKCJjb3VudHJ5IiwgIlNHIikKZGVmIGF0dHJpYnV0ZXMgPSBpZGVudGl0eS5nZXRBdHRyaWJ1dGVzKFsic2NiLVJlbElEIiwic2NiLWxhc3RMb2dpblRpbWUiLCJzY2ItRUJJRCJdLnRvU2V0KCkpCmlmIChhdHRyaWJ1dGVzWyJzY2ItUmVsSUQiXSAhPSBudWxsKSB7CiAgYWNjZXNzVG9rZW4uc2V0RmllbGQoInJlbGlkIiwgYXR0cmlidXRlc1sic2NiLVJlbElEIl1bMF0pCn0KaWYgKGF0dHJpYnV0ZXNbInNjYi1FQklEIl0gIT0gbnVsbCkgewogIGFjY2Vzc1Rva2VuLnNldEZpZWxkKCJyZWxpZCIsIGF0dHJpYnV0ZXNbInNjYi1FQklEIl1bMF0pCn0KZGVmIGxhc3RMb2dpblRpbWUgPSAiIgppZiAoYXR0cmlidXRlc1sic2NiLWxhc3RMb2dpblRpbWUiXSAhPSBudWxsKSB7CiAgICBsYXN0TG9naW5UaW1lID0gYXR0cmlidXRlc1sic2NiLWxhc3RMb2dpblRpbWUiXVswXQp9CmFjY2Vzc1Rva2VuLnNldEZpZWxkKCJsYXN0TG9naW5UaW1lIiwgbGFzdExvZ2luVGltZSkKCi8qKgogKiBEZWZpbmVkIHZhcmlhYmxlczoKICogYWNjZXNzVG9rZW4gLSBUaGUgYWNjZXNzIHRva2VuIHRvIGJlIHVwZGF0ZWQuIE11dGFibGUgb2JqZWN0LCBhbGwgY2hhbmdlcyB0byB0aGUgYWNjZXNzIHRva2VuIHdpbGwgYmUgcmVmbGVjdGVkLgogKiBodHRwQ2xpZW50IC0gYWx3YXlzIHByZXNlbnQsIHRoZSBIVFRQIGNsaWVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIG1ha2UgZXh0ZXJuYWwgSFRUUCByZXF1ZXN0cwogKiBpZGVudGl0eSAtIGFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyCiAqIGxvZ2dlciAtIGFsd2F5cyBwcmVzZW50LCBjb3JyZXNwb25kaW5nIGxvZyBmaWxlcyB3aWxsIGJlIHByZWZpeGVkIHdpdGg6IHNjcmlwdHMuT0FVVEgyX0FDQ0VTU19UT0tFTl9NT0RJRklDQVRJT04uCiAqIHNjb3BlcyAtIGFsd2F5cyBwcmVzZW50LCB0aGUgcmVxdWVzdGVkIHNjb3BlcwogKiBzZXNzaW9uIC0gcHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QKICoKICogTm8gcmV0dXJuIHZhbHVlIC0gY2hhbmdlcyBzaGFsbCBiZSBtYWRlIHRvIHRoZSBhY2Nlc3NUb2tlbiBwYXJhbWV0ZXIgZGlyZWN0bHkuCiAqCiAqIFRoZSBjaGFuZ2VzIG1hZGUgdG8gT0F1dGgyIGFjY2VzcyB0b2tlbnMgd2lsbCBkaXJlY3RseSBpbXBhY3QgdGhlIHNpemUgb2YgdGhlIENUUyB0b2tlbnMsIGFuZCBzaW1pbGFybHkgdGhlIHNpemUgb2YKICogdGhlIEpXVHMgaWYgY2xpZW50IGJhc2VkIE9BdXRoMiB0b2tlbnMgYXJlIHV0aWxpc2VkLgogKiBXaGVuIGFkZGluZy91cGRhdGluZyBmaWVsZHMgbWFrZSBzdXJlIHRoYXQgdGhlIHRva2VuIHNpemUgcmVtYWlucyB3aXRoaW4gY2xpZW50L3VzZXItYWdlbnQgbGltaXRzLgogKi8KCi8qCi8vRmllbGQgdG8gYWx3YXlzIGluY2x1ZGUgaW4gdG9rZW4KYWNjZXNzVG9rZW4uc2V0RmllbGQoImhlbGxvIiwgIndvcmxkIikKCi8vT2J0YWluIGFkZGl0aW9uYWwgdmFsdWVzIGJ5IHBlcmZvcm1pbmcgYSBSRVNUIGNhbGwgdG8gYW4gZXh0ZXJuYWwgc2VydmljZQp0cnkgewogICAgUmVzcG9uc2UgcmVzcG9uc2UgPSBodHRwQ2xpZW50LnNlbmQobmV3IFJlcXVlc3QoKQogICAgICAgICAgICAuc2V0VXJpKCJodHRwczovL3RoaXJkLnBhcnR5LmFwcC9oZWxsby5qc3AiKQogICAgICAgICAgICAuc2V0TWV0aG9kKCJQT1NUIikKICAgICAgICAgICAgLm1vZGlmeUhlYWRlcnMoeyBoZWFkZXJzIC0+IGhlYWRlcnMucHV0KCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04IikgfSkKLy8gICAgICAgICAgLnNldEVudGl0eSgnZm9vPWJhciZoZWxsbz13b3JsZCcpKQogICAgICAgICAgICAuc2V0RW50aXR5KFtmb286ICdiYXInXSkpCiAgICAgICAgICAgIC5nZXRPclRocm93KCkKICAgIGlmIChyZXNwb25zZS5zdGF0dXMuc3VjY2Vzc2Z1bCkgewogICAgICAgIGRlZiByZXN1bHQgPSBuZXcgSnNvblNsdXJwZXIoKS5wYXJzZVRleHQocmVzcG9uc2UuZW50aXR5LnN0cmluZykKICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZHMocmVzdWx0LmdldCgidXBkYXRlZEZpZWxkcyIpKQogICAgfSBlbHNlIHsKICAgICAgICBsb2dnZXIuZXJyb3IoIlVuYWJsZSB0byBvYnRhaW4gYWNjZXNzIHRva2VuIG1vZGlmaWNhdGlvbnM6IHt9LCB7fSIsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UuZW50aXR5LnRvU3RyaW5nKCkpCiAgICB9Cn0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGV4KSB7CiAgICBsb2dnZXIuZXJyb3IoIlRoZSByZXF1ZXN0IHByb2Nlc3Npbmcgd2FzIGludGVycnVwdGVkIiwgZXgpCiAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpCiAgICAvL1RoZSBhY2Nlc3MgdG9rZW4gcmVxdWVzdCB3aWxsIGZhaWwgd2l0aCBIVFRQIDUwMCBlcnJvciBpbiB0aGlzIGNhc2UuCiAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigiVW5hYmxlIHRvIG9idGFpbiByZXNwb25zZSBmcm9tICIpCn0KCi8vQWRkIG5ldyBmaWVsZHMgY29udGFpbmluZyBpZGVudGl0eSBhdHRyaWJ1dGUgdmFsdWVzCmRlZiBhdHRyaWJ1dGVzID0gaWRlbnRpdHkuZ2V0QXR0cmlidXRlcyhbIm1haWwiLCAidGVsZXBob25lTnVtYmVyIl0udG9TZXQoKSkKYWNjZXNzVG9rZW4uc2V0RmllbGQoIm1haWwiLCBhdHRyaWJ1dGVzWyJtYWlsIl0pCmFjY2Vzc1Rva2VuLnNldEZpZWxkKCJwaG9uZSIsIGF0dHJpYnV0ZXNbInRlbGVwaG9uZU51bWJlciJdKQoKLy9BZGQgbmV3IGZpZWxkcyBjb250YWluaW5nIHNlc3Npb24gcHJvcGVydHkgdmFsdWVzCmlmIChzZXNzaW9uICE9IG51bGwpIHsgLy8gc2Vzc2lvbiBpcyBub3QgYXZhaWxhYmxlIGZvciByZXNvdXJjZSBvd25lciBwYXNzd29yZCBjcmVkZW50aWFscyBncmFudAogICAgdHJ5IHsKICAgICAgICBhY2Nlc3NUb2tlbi5zZXRGaWVsZCgiaXBBZGRyZXNzIiwgc2Vzc2lvbi5nZXRQcm9wZXJ0eSgiSG9zdCIpKQogICAgfSBjYXRjaCAoU1NPRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgbG9nZ2VyLmVycm9yKCJVbmFibGUgdG8gcmV0cmlldmUgc2Vzc2lvbiBwcm9wZXJ0eSB2YWx1ZSIsIGV4KQogICAgfQp9CgovLyBSZW1vdmUgYSBuYXRpdmUgZmllbGQgZnJvbSB0aGUgdG9rZW4gZW50cnksIHRoYXQgd2FzIHNldCBieSBBTS4gRm9yIGNvbXBsZXRlIGxpc3Qgb2YgcmVtb3ZlKiBtZXRob2RzIHNlZSB0aGUgSmF2YURvYwovLyBmb3Igb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5BY2Nlc3NUb2tlbiBjbGFzcy4KYWNjZXNzVG9rZW4ucmVtb3ZlVG9rZW5OYW1lKCkKKi8=","default":true,"language":"GROOVY","context":"OAUTH2_ACCESS_TOKEN_MODIFICATION","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
update Scripts --realm sg-external --id 36863ffb-40ec-48b9-94b1-9a99f71cc3b5 --body '{"name":"OIDC Claims Script","description":"Default global script for OIDC claims","script":"LyoKICogQ29weXJpZ2h0IDIwMTQtMjAxOSBGb3JnZVJvY2sgQVMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQKICoKICogVXNlIG9mIHRoaXMgY29kZSByZXF1aXJlcyBhIGNvbW1lcmNpYWwgc29mdHdhcmUgbGljZW5zZSB3aXRoIEZvcmdlUm9jayBBUy4KICogb3Igd2l0aCBvbmUgb2YgaXRzIGFmZmlsaWF0ZXMuIEFsbCB1c2Ugc2hhbGwgYmUgZXhjbHVzaXZlbHkgc3ViamVjdAogKiB0byBzdWNoIGxpY2Vuc2UgYmV0d2VlbiB0aGUgbGljZW5zZWUgYW5kIEZvcmdlUm9jayBBUy4KICovCmltcG9ydCBjb20uaXBsYW5ldC5zc28uU1NPRXhjZXB0aW9uCmltcG9ydCBjb20uc3VuLmlkZW50aXR5LmlkbS5JZFJlcG9FeGNlcHRpb24KaW1wb3J0IG9yZy5mb3JnZXJvY2sub2F1dGgyLmNvcmUuZXhjZXB0aW9ucy5JbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbgppbXBvcnQgb3JnLmZvcmdlcm9jay5vYXV0aDIuY29yZS5Vc2VySW5mb0NsYWltcwppbXBvcnQgb3JnLmZvcmdlcm9jay5vcGVuaWRjb25uZWN0LkNsYWltCmltcG9ydCBncm9vdnkuanNvbi5Kc29uU2x1cnBlcgppbXBvcnQgb3JnLmFwYWNoZS5ncm9vdnkuanNvbi5pbnRlcm5hbC5MYXp5TWFwCmltcG9ydCBqYXZhLnRpbWUuWm9uZWREYXRlVGltZQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcgovKgoqIERlZmluZWQgdmFyaWFibGVzOgoqIGxvZ2dlciAtIGFsd2F5cyBwcmVzZW50cywgdGhlICJPQXV0aDJQcm92aWRlciIgZGVidWcgbG9nZ2VyIGluc3RhbmNlCiogY2xhaW1zIC0gYWx3YXlzIHByZXNlbnQsIGRlZmF1bHQgc2VydmVyIHByb3ZpZGVkIGNsYWltcyAtIE1hcDxTdHJpbmcsIE9iamVjdD4KKiBjbGFpbU9iamVjdHMgLSBhbHdheXMgcHJlc2VudCwgZGVmYXVsdCBzZXJ2ZXIgcHJvdmlkZWQgY2xhaW1zIC0gTGlzdDxDbGFpbT4KKiBzZXNzaW9uIC0gcHJlc2VudCBpZiB0aGUgcmVxdWVzdCBjb250YWlucyB0aGUgc2Vzc2lvbiBjb29raWUsIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBvYmplY3QKKiBpZGVudGl0eSAtIGFsd2F5cyBwcmVzZW50LCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG93bmVyCiogc2NvcGVzIC0gYWx3YXlzIHByZXNlbnQsIHRoZSByZXF1ZXN0ZWQgc2NvcGVzCiogcmVxdWVzdGVkQ2xhaW1zIC0gTWFwPFN0cmluZywgU2V0PFN0cmluZz4+CiogICAgICAgICAgICAgICAgICBhbHdheXMgcHJlc2VudCwgbm90IGVtcHR5IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIGEgY2xhaW1zIHBhcmFtZXRlciBhbmQgc2VydmVyIGhhcyBlbmFibGVkCiogICAgICAgICAgICAgICAgICBjbGFpbXNfcGFyYW1ldGVyX3N1cHBvcnRlZCwgbWFwIG9mIHJlcXVlc3RlZCBjbGFpbXMgdG8gcG9zc2libGUgdmFsdWVzLCBvdGhlcndpc2UgZW1wdHksCiogICAgICAgICAgICAgICAgICByZXF1ZXN0ZWQgY2xhaW1zIHdpdGggbm8gcmVxdWVzdGVkIHZhbHVlcyB3aWxsIGhhdmUgYSBrZXkgYnV0IG5vIHZhbHVlIGluIHRoZSBtYXAuIEEga2V5IHdpdGgKKiAgICAgICAgICAgICAgICAgIGEgc2luZ2xlIHZhbHVlIGluIGl0cyBTZXQgaW5kaWNhdGVzIHRoaXMgaXMgdGhlIG9ubHkgdmFsdWUgdGhhdCBzaG91bGQgYmUgcmV0dXJuZWQuCiogcmVxdWVzdGVkVHlwZWRDbGFpbXMgLSBMaXN0PENsYWltPgoqICAgICAgICAgICAgICAgICAgICAgICBhbHdheXMgcHJlc2VudCwgbm90IGVtcHR5IGlmIHRoZSByZXF1ZXN0IGNvbnRhaW5zIGEgY2xhaW1zIHBhcmFtZXRlciBhbmQgc2VydmVyIGhhcyBlbmFibGVkCiogICAgICAgICAgICAgICAgICAgICAgIGNsYWltc19wYXJhbWF0ZXJfc3VwcG9ydGVkLCBsaXN0IG9mIHJlcXVlc3RlZCBjbGFpbXMgd2l0aCBjbGFpbSBuYW1lLCByZXF1ZXN0ZWQgcG9zc2libGUgdmFsdWVzCiogICAgICAgICAgICAgICAgICAgICAgIGFuZCBpZiBjbGFpbSBpcyBlc3NlbnRpYWwsIG90aGVyd2lzZSBlbXB0eSwKKiAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkIGNsYWltcyB3aXRoIG5vIHJlcXVlc3RlZCB2YWx1ZXMgd2lsbCBoYXZlIGEgY2xhaW0gd2l0aCBubyB2YWx1ZXMuIEEgY2xhaW1zIHdpdGgKKiAgICAgICAgICAgICAgICAgICAgICAgYSBzaW5nbGUgdmFsdWUgaW5kaWNhdGVzIHRoaXMgaXMgdGhlIG9ubHkgdmFsdWUgdGhhdCBzaG91bGQgYmUgcmV0dXJuZWQuCiogY2xhaW1zTG9jYWxlcyAtIHRoZSB2YWx1ZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBwYXJhbWV0ZXIgLSBMaXN0PFN0cmluZz4KKiBSZXF1aXJlZCB0byByZXR1cm4gYSBNYXAgb2YgY2xhaW1zIHRvIGJlIGFkZGVkIHRvIHRoZSBpZF90b2tlbiBjbGFpbXMKKgoqIEV4cGVjdGVkIHJldHVybiB2YWx1ZSBzdHJ1Y3R1cmU6CiogVXNlckluZm9DbGFpbXMgewoqICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gdmFsdWVzOyAvLyBUaGUgdmFsdWVzIG9mIHRoZSBjbGFpbXMgZm9yIHRoZSB1c2VyIGluZm9ybWF0aW9uCiogICAgTWFwPFN0cmluZywgTGlzdDxTdHJpbmc+PiBjb21wb3NpdGVTY29wZXM7IC8vIE1hcHBpbmcgb2Ygc2NvcGUgbmFtZSB0byBhIGxpc3Qgb2YgY2xhaW0gbmFtZXMuCiogfQoqLwoKLy8gdXNlciBzZXNzaW9uIG5vdCBndWFyYW50ZWVkIHRvIGJlIHByZXNlbnQKYm9vbGVhbiBzZXNzaW9uUHJlc2VudCA9IHNlc3Npb24gIT0gbnVsbAoKLyoKICogUHVsbHMgZmlyc3QgdmFsdWUgZnJvbSB1c2VycyBwcm9maWxlIGF0dHJpYnV0ZQogKgogKiBAcGFyYW0gY2xhaW0gVGhlIGNsYWltIG9iamVjdC4KICogQHBhcmFtIGF0dHIgVGhlIHByb2ZpbGUgYXR0cmlidXRlIG5hbWUuCiAqLwpkZWYgZnJvbVNldCA9IHsgY2xhaW0sIGF0dHIgLT4KICAgIGlmIChhdHRyICE9IG51bGwgJiYgYXR0ci5zaXplKCkgPT0gMSl7CiAgICAgICAgYXR0ci5pdGVyYXRvcigpLm5leHQoKQogICAgfSBlbHNlIGlmIChhdHRyICE9IG51bGwgJiYgYXR0ci5zaXplKCkgPiAxKXsKICAgICAgICBhdHRyCiAgICB9IGVsc2UgaWYgKGxvZ2dlci53YXJuaW5nRW5hYmxlZCgpKSB7CiAgICAgICAgbG9nZ2VyLndhcm5pbmcoIk9wZW5BTVNjb3BlVmFsaWRhdG9yLmdldFVzZXJJbmZvKCk6IEdvdCBhbiBlbXB0eSByZXN1bHQgZm9yIGNsYWltPSRjbGFpbSIpOwogICAgfQp9CgovLyAtLS12dnZ2dnZ2dnZ2LS0tIEVYQU1QTEUgQ0xBSU0gQVRUUklCVVRFIFJFU09MVkVSIEZVTkNUSU9OUyAtLS12dnZ2dnZ2dnZ2LS0tCi8qCiAqIENsYWltIHJlc29sdmVyIHdoaWNoIHJlc29sdmVzIHRoZSB2YWx1ZSBvZiB0aGUgY2xhaW0gZnJvbSBpdHMgcmVxdWVzdGVkIHZhbHVlcy4KICoKICogVGhpcyByZXNvbHZlciB3aWxsIHJldHVybiBhIHZhbHVlIGlmIHRoZSBjbGFpbSBoYXMgb25lIHJlcXVlc3RlZCB2YWx1ZXMsIG90aGVyd2lzZSBhbiBleGNlcHRpb24gaXMgdGhyb3duLgogKi8KZGVmYXVsdENsYWltUmVzb2x2ZXIgPSB7IGNsYWltIC0+CiAgICBpZiAoY2xhaW0uZ2V0VmFsdWVzKCkuc2l6ZSgpID09IDEpIHsKICAgICAgICBbKGNsYWltLmdldE5hbWUoKSk6IGNsYWltLmdldFZhbHVlcygpLml0ZXJhdG9yKCkubmV4dCgpXQogICAgfSBlbHNlIHsKICAgICAgICBbOl0KICAgIH0KfQoKLyoKICogQ2xhaW0gcmVzb2x2ZXIgd2hpY2ggcmVzb2x2ZXMgdGhlIHZhbHVlIG9mIHRoZSBjbGFpbSBieSBsb29raW5nIHVwIHRoZSB1c2VyJ3MgcHJvZmlsZS4KICoKICogVGhpcyByZXNvbHZlciB3aWxsIHJldHVybiBhIHZhbHVlIGZvciB0aGUgY2xhaW0gaWY6CiAqICMgdGhlIHVzZXIncyBwcm9maWxlIGF0dHJpYnV0ZSBpcyBub3QgbnVsbAogKiAjIEFORCB0aGUgY2xhaW0gY29udGFpbnMgbm8gcmVxdWVzdGVkIHZhbHVlcwogKiAjIE9SIHRoZSBjbGFpbSBjb250YWlucyByZXF1ZXN0ZWQgdmFsdWVzIGFuZCB0aGUgdmFsdWUgZnJvbSB0aGUgdXNlcidzIHByb2ZpbGUgaXMgaW4gdGhlIGxpc3Qgb2YgdmFsdWVzCiAqCiAqIElmIG5vIG1hdGNoIGlzIGZvdW5kIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24uCiAqLwoKbmFtZVJlc29sdmVyID0geyBhdHRyaWJ1dGUsIGNsYWltLCBpZGVudGl0eSAtPgogICAgdXNlclByb2ZpbGVWYWx1ZSA9IGZyb21TZXQoY2xhaW0uZ2V0TmFtZSgpLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSkKICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICE9IG51bGwgJiYgKGNsYWltLmdldFZhbHVlcygpID09IG51bGwgfHwgY2xhaW0uZ2V0VmFsdWVzKCkuaXNFbXB0eSgpIHx8IGNsYWltLmdldFZhbHVlcygpLmNvbnRhaW5zKHVzZXJQcm9maWxlVmFsdWUpKSkgewogICAgICAgIGRlZiB2YWx1ZSA9IHRvSnNvbih1c2VyUHJvZmlsZVZhbHVlKQogICAgICAgIC8vIEB0b2RvIG5hbWUgaW5jbHVkaW5nIGFsbCBuYW1lIHBhcnRzLCBwb3NzaWJseSBpbmNsdWRpbmcgdGl0bGVzIGFuZCBzdWZmaXhlcywgb3JkZXJlZCBhY2NvcmRpbmcgdG8gdGhlIEVuZC1Vc2VyJ3MgbG9jYWxlIGFuZCBwcmVmZXJlbmNlcy4KICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBMYXp5TWFwKSB7CiAgICAgICAgICAJaWYgKHZhbHVlLmdpdmVuTmFtZSAmJiB2YWx1ZS5mYW1pbHlOYW1lICYmIHZhbHVlLm1pZGRsZU5hbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgImZhbWlseV9uYW1lIjogdmFsdWUuZmFtaWx5TmFtZSwKICAgICAgICAgICAgICAgICAgICAiZ2l2ZW5fbmFtZSI6IHZhbHVlLmdpdmVuTmFtZSwKICAgICAgICAgICAgICAgICAgCSJtaWRkbGVfbmFtZSI6IHZhbHVlLm1pZGRsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiJHZhbHVlLmdpdmVuTmFtZSAkdmFsdWUubWlkZGxlTmFtZSAkdmFsdWUuZmFtaWx5TmFtZSIudHJpbSgpLAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmdpdmVuTmFtZSAmJiB2YWx1ZS5mYW1pbHlOYW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAgICAgICAgICJmYW1pbHlfbmFtZSI6IHZhbHVlLmZhbWlseU5hbWUsCiAgICAgICAgICAgICAgICAgICAgImdpdmVuX25hbWUiOiB2YWx1ZS5naXZlbk5hbWUsCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiJHZhbHVlLmdpdmVuTmFtZSAkdmFsdWUuZmFtaWx5TmFtZSIudHJpbSgpLAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmZhbWlseU5hbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgImZhbWlseV9uYW1lIjogdmFsdWUuZmFtaWx5TmFtZSwKICAgICAgICAgICAgICAgICAgICAibmFtZSI6IHZhbHVlLmZhbWlseU5hbWUsCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUuZ2l2ZW5OYW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAgICAgICAgICJnaXZlbl9uYW1lIjogdmFsdWUuZ2l2ZW5OYW1lLAogICAgICAgICAgICAgICAgICAgICJuYW1lIjogdmFsdWUuZ2l2ZW5OYW1lLAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAibmFtZSI6IHZhbHVlLAogICAgICAgICAgICBdCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgICAgICJuYW1lIjogdmFsdWUsCiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICB9CiAgICBbOl0KfQoKYWRkcmVzc1Jlc29sdmVyID0geyBhdHRyaWJ1dGUsIGNsYWltLCBpZGVudGl0eSAtPgogIAlkZWYgbmFtZSA9IGNsYWltLmdldE5hbWUoKQogICAgbG9nZ2VyLm1lc3NhZ2UoImFkZHJlc3NSZXNvbHZlcjogIiArIG5hbWUpCiAgICAKICAJZGVmIGpzb25WYWx1ZSA9IGZyb21TZXQobmFtZSwgaWRlbnRpdHkuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkpCglpZiAoanNvblZhbHVlID09IG51bGwpIHsKICAgIAlyZXR1cm4gWzpdCiAgCX0KICAKICAJZGVmIGFkZHJlc3MgPSB0b0pzb24oanNvblZhbHVlKQoKICAJLy8gQ3JlYXRlIGluZGl2aWR1YWwgcHJvcGVydGllcwogIAlkZWYgbWFwID0gWzpdCiAgCWlmIChhZGRyZXNzLnN0cmVldEFkZHJlc3MpIHsKICAgIAltYXAucHV0KCJzdHJlZXRfYWRkcmVzcyIsIGFkZHJlc3Muc3RyZWV0QWRkcmVzcykKICAJfQogIAlpZiAoYWRkcmVzcy5sb2NhbGl0eSkgewogICAgCW1hcC5wdXQoImxvY2FsaXR5IiwgYWRkcmVzcy5sb2NhbGl0eSkKICAJfQogIAlpZiAoYWRkcmVzcy5yZWdpb24pIHsKICAgIAltYXAucHV0KCJyZWdpb24iLCBhZGRyZXNzLnJlZ2lvbikKICAJfQogIAlpZiAoYWRkcmVzcy5wb3N0YWxDb2RlKSB7CiAgICAJbWFwLnB1dCgicG9zdGFsX2NvZGUiLCBhZGRyZXNzLnBvc3RhbENvZGUpCiAgCX0KICAJaWYgKGFkZHJlc3MuY291bnRyeSkgewogICAgCW1hcC5wdXQoImNvdW50cnkiLCBhZGRyZXNzLmNvdW50cnkpCiAgCX0KICAKICAJLy8gQ3JlYXRlIGZvcm1hdHRlZCBhZGRyZXNzCiAgCWRlZiBmb3JtYXR0ZWQgPSBbXQogIAlkZWYgbG9jYWxpdHlSZWdpb25TZXAgPSAiLCAiCiAgCWlmICghYWRkcmVzcy5sb2NhbGl0eSB8fCAhYWRkcmVzcy5yZWdpb24pIHsKICAgIAlsb2NhbGl0eVJlZ2lvblNlcCA9ICIiCiAgCX0KICAJaWYgKGFkZHJlc3Muc3RyZWV0QWRkcmVzcykgewogICAgICAJZm9ybWF0dGVkIDw8IGFkZHJlc3Muc3RyZWV0QWRkcmVzcwogIAl9CiAgCWlmIChhZGRyZXNzLmxvY2FsaXR5IHx8IGFkZHJlc3MucmVnaW9uIHx8IGFkZHJlc3MucG9zdGFsQ29kZSkgewogICAgCWZvcm1hdHRlZCA8PCAoYWRkcmVzcy5sb2NhbGl0eSArIGxvY2FsaXR5UmVnaW9uU2VwICsgYWRkcmVzcy5yZWdpb24gKyAiICIgKyBhZGRyZXNzLnBvc3RhbENvZGUpLnRyaW0oKQogIAl9CiAgCWlmIChhZGRyZXNzLmNvdW50cnkpIHsKICAgIAlmb3JtYXR0ZWQgPDwgYWRkcmVzcy5jb3VudHJ5CiAgCX0KICAJaWYgKGZvcm1hdHRlZC5zaXplKCkgPiAwKSB7CiAgICAJbWFwLnB1dCgiZm9ybWF0dGVkIiwgZm9ybWF0dGVkLmpvaW4oIlxuIikpCiAgCX0KICAgICAgICAgICAgICAKICAgCXJldHVybiBbYWRkcmVzczogbWFwXQp9CgphdHRyaWJ1dGVSZXNvbHZlciA9IHsgYXR0cmlidXRlLCBmaWVsZCwgdXNlUHJpbWFyeSwgYWRkVmVyaWZpZWQsIGNsYWltLCBpZGVudGl0eSAtPgogIAluYW1lID0gY2xhaW0uZ2V0TmFtZSgpCiAgICBsb2dnZXIubWVzc2FnZSgiYXR0cmlidXRlUmVzb2x2ZXI6ICIgKyBuYW1lKQogIAogICAgdmFsdWUgPSBmcm9tU2V0KG5hbWUsIGlkZW50aXR5LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpKQoKICAJaWYgKHZhbHVlICE9IG51bGwgJiYgKGNsYWltLmdldFZhbHVlcygpID09IG51bGwgfHwgY2xhaW0uZ2V0VmFsdWVzKCkuaXNFbXB0eSgpIHx8IGNsYWltLmdldFZhbHVlcygpLmNvbnRhaW5zKHZhbHVlKSkpIHsKICAgICAgICB2YWx1ZSA9IHRvSnNvbih2YWx1ZSkKICAgICAgICBpZiAodXNlUHJpbWFyeSkgewogICAgICAgICAgICB2YWx1ZSA9IGdldFByaW1hcnlPckZpcnN0KHZhbHVlKQogICAgICAgIH0KICAgICAgCiAgICAgICAJaXNNYXAgPSB2YWx1ZSAhPSBudWxsICYmIHZhbHVlIGluc3RhbmNlb2YgTGF6eU1hcAogICAgICAgCWhhc0ZpZWxkID0gaXNNYXAgJiYgZmllbGQgaW5zdGFuY2VvZiBTdHJpbmcgJiYgdmFsdWUuY29udGFpbnNLZXkoZmllbGQpCiAgICAgIAloYXNWZXJpZmllZCA9IGlzTWFwICYmIHZhbHVlLmNvbnRhaW5zS2V5KCJ2ZXJpZmllZCIpCgogICAgICAJaWYgKGFkZFZlcmlmaWVkICYmIGhhc1ZlcmlmaWVkKSB7ICAgICAgICAgIAkKICAgICAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgICAgIChuYW1lICsgIl92ZXJpZmllZCIpOiBoYXNWZXJpZmllZCAmJiB2YWx1ZS52ZXJpZmllZCA9PSB0cnVlLAogICAgICAgICAgICAgICAgKG5hbWUpOiBoYXNGaWVsZCA/IHZhbHVlW2ZpZWxkXSA6IHZhbHVlLAogICAgICAgICAgICBdCiAgICAgICAgfQogICAgICAKICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAobmFtZSk6IGhhc0ZpZWxkID8gdmFsdWVbZmllbGRdIDogdmFsdWUsCiAgICAgICAgXQogICAgfQogICAgWzpdCn0KCmJhc2ljUmVzb2x2ZXIgPSB7IGF0dHJpYnV0ZSwgY2xhaW0sIGlkZW50aXR5IC0+CiAgICBuYW1lID0gY2xhaW0uZ2V0TmFtZSgpCiAgICBsb2dnZXIubWVzc2FnZSgiYmFzaWNSZXNvbHZlcjogIiArIG5hbWUpCiAgICB1c2VyUHJvZmlsZVZhbHVlID0gZnJvbVNldChuYW1lLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSkKICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICE9IG51bGwgJiYgKGNsYWltLmdldFZhbHVlcygpID09IG51bGwgfHwgY2xhaW0uZ2V0VmFsdWVzKCkuaXNFbXB0eSgpIHx8IGNsYWltLmdldFZhbHVlcygpLmNvbnRhaW5zKHVzZXJQcm9maWxlVmFsdWUpKSkgewogICAgICAgIGRlZiB2YWx1ZSA9IHRvSnNvbih1c2VyUHJvZmlsZVZhbHVlKQogICAgICAgIHZhbHVlID0gZ2V0UHJpbWFyeU9yRmlyc3QodmFsdWUpCiAgICAgICAgcmV0dXJuIFsobmFtZSk6IHZhbHVlXQogICAgfQogICAgWzpdCn0KCmRhdGVSZXNvbHZlciA9IHsgYXR0cmlidXRlLCBjbGFpbSwgaWRlbnRpdHkgLT4KICAgIG5hbWUgPSBjbGFpbS5nZXROYW1lKCkKICAgIGxvZ2dlci5tZXNzYWdlKCJkYXRlUmVzb2x2ZXI6ICIgKyBuYW1lKQogICAgdXNlclByb2ZpbGVWYWx1ZSA9IGZyb21TZXQobmFtZSwgaWRlbnRpdHkuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkpCiAgICBpZiAodXNlclByb2ZpbGVWYWx1ZSAhPSBudWxsICYmIChjbGFpbS5nZXRWYWx1ZXMoKSA9PSBudWxsIHx8IGNsYWltLmdldFZhbHVlcygpLmlzRW1wdHkoKSB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5jb250YWlucyh1c2VyUHJvZmlsZVZhbHVlKSkpIHsKICAgICAgCWRlZiB2YWx1ZSA9IHRvSnNvbih1c2VyUHJvZmlsZVZhbHVlKQogICAgICAJdmFsdWUgPSBnZXRQcmltYXJ5T3JGaXJzdCh2YWx1ZSkKICAgICAgICBkZWYgZGF0ZUZvcm1hdCA9IG5ldyBqYXZhLnRleHQuU2ltcGxlRGF0ZUZvcm1hdCgieXl5eU1NZGRISG1tc3MiKQogICAgICAgIGRlZiBkYXRlID0gZGF0ZUZvcm1hdC5wYXJzZSh2YWx1ZSk7CgkJcmV0dXJuIFsobmFtZSk6IGRhdGUudGltZSAvIDEwMDBdCiAgICB9CiAgICBbOl0KfQoKZ2V0UHJpbWFyeU9yRmlyc3QgPSB7IHZhbHVlIC0+CiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBqYXZhLnV0aWwuQXJyYXlMaXN0KSB7CiAgICAgICAgLy8gbG9vayBmb3IgcHJpbWFyeQogICAgICAgIGZvciAoaXRlbSBpbiB2YWx1ZSkgewogICAgICAgICAgCW9iaiA9IHRvSnNvbihpdGVtKQogICAgICAgICAgICBpZiAob2JqLmhhc1Byb3BlcnR5KCJwcmltYXJ5IikgJiYgb2JqLnByaW1hcnkgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG9iagogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIHJldHVybiBmaXJzdAogICAgICAgIHJldHVybiB0b0pzb24odmFsdWVbMF0pCiAgICB9CiAgICByZXR1cm4gdmFsdWUKfQoKdG9Kc29uID0geyB2YWx1ZSAtPgogICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgamF2YS51dGlsLkhhc2hTZXQpIHsKICAgICAgICBkZWYganNvblNldCA9IFtdCiAgICAgICAgdmFsdWUuZWFjaCB7IGkgLT4KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGpzb25TZXQuYWRkKHRvSnNvbihpKSkKICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICBqc29uU2V0LmFkZChpKQogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICByZXR1cm4ganNvblNldAogICAgfQogICAgdHJ5IHsKICAgICAgICByZXR1cm4gbmV3IEpzb25TbHVycGVyKCkucGFyc2VUZXh0KHZhbHVlKQogICAgfSBjYXRjaChlKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlCiAgICB9Cn0KCgovKgogKiBDbGFpbSByZXNvbHZlciB3aGljaCByZXNvbHZlcyB0aGUgdmFsdWUgb2YgdGhlIGNsYWltIGJ5IGxvb2tpbmcgdXAgdGhlIHVzZXIncyBwcm9maWxlLgogKgogKiBUaGlzIHJlc29sdmVyIHdpbGwgcmV0dXJuIGEgdmFsdWUgZm9yIHRoZSBjbGFpbSBpZjoKICogIyB0aGUgdXNlcidzIHByb2ZpbGUgYXR0cmlidXRlIGlzIG5vdCBudWxsCiAqICMgQU5EIHRoZSBjbGFpbSBjb250YWlucyBubyByZXF1ZXN0ZWQgdmFsdWVzCiAqICMgT1IgdGhlIGNsYWltIGNvbnRhaW5zIHJlcXVlc3RlZCB2YWx1ZXMgYW5kIHRoZSB2YWx1ZSBmcm9tIHRoZSB1c2VyJ3MgcHJvZmlsZSBpcyBpbiB0aGUgbGlzdCBvZiB2YWx1ZXMKICoKICogSWYgdGhlIGNsYWltIGlzIGVzc2VudGlhbCBhbmQgbm8gdmFsdWUgaXMgZm91bmQgYW4gSW52YWxpZFJlcXVlc3RFeGNlcHRpb24gd2lsbCBiZSB0aHJvd24gYW5kIHJldHVybmVkIHRvIHRoZSB1c2VyLgogKiBJZiBubyBtYXRjaCBpcyBmb3VuZCBhbiBleGNlcHRpb24gaXMgdGhyb3duLgogKi8KZXNzZW50aWFsQ2xhaW1SZXNvbHZlciA9IHsgYXR0cmlidXRlLCBjbGFpbSwgaWRlbnRpdHkgLT4KICAgIHVzZXJQcm9maWxlVmFsdWUgPSBmcm9tU2V0KGNsYWltLmdldE5hbWUoKSwgaWRlbnRpdHkuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkpCiAgICBpZiAoY2xhaW0uaXNFc3NlbnRpYWwoKSAmJiAodXNlclByb2ZpbGVWYWx1ZSA9PSBudWxsIHx8IHVzZXJQcm9maWxlVmFsdWUuaXNFbXB0eSgpKSkgewogICAgICAgIHRocm93IG5ldyBJbnZhbGlkUmVxdWVzdEV4Y2VwdGlvbigiQ291bGQgbm90IHByb3ZpZGUgdmFsdWUgZm9yIGVzc2VudGlhbCBjbGFpbSAkY2xhaW0iKQogICAgfQogICAgaWYgKHVzZXJQcm9maWxlVmFsdWUgIT0gbnVsbCAmJiAoY2xhaW0uZ2V0VmFsdWVzKCkgPT0gbnVsbCB8fCBjbGFpbS5nZXRWYWx1ZXMoKS5pc0VtcHR5KCkgfHwgY2xhaW0uZ2V0VmFsdWVzKCkuY29udGFpbnModXNlclByb2ZpbGVWYWx1ZSkpKSB7CiAgICAgICAgcmV0dXJuIFsoY2xhaW0uZ2V0TmFtZSgpKTogdXNlclByb2ZpbGVWYWx1ZV0KICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFs6XQogICAgfQp9CgovKgogKiBDbGFpbSByZXNvbHZlciB3aGljaCBleHBlY3RzIHRoZSB1c2VyJ3MgcHJvZmlsZSBhdHRyaWJ1dGUgdmFsdWUgdG8gYmUgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6CiAqICJsYW5ndWFnZV90YWd8dmFsdWVfZm9yX2xhbmd1YWdlLC4uLiIuCiAqCiAqIFRoaXMgcmVzb2x2ZXIgd2lsbCB0YWtlIHRoZSBsaXN0IG9mIHJlcXVlc3RlZCBsYW5ndWFnZXMgZnJvbSB0aGUgJ2NsYWltc19sb2NhbGVzJyBhdXRob3JpemUgcmVxdWVzdAogKiBwYXJhbWV0ZXIgYW5kIGF0dGVtcHQgdG8gbWF0Y2ggaXQgdG8gYSB2YWx1ZSBmcm9tIHRoZSB1c2VycycgcHJvZmlsZSBhdHRyaWJ1dGUuCiAqIElmIG5vIG1hdGNoIGlzIGZvdW5kIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24uCiAqLwpjbGFpbUxvY2FsZXNDbGFpbVJlc29sdmVyID0geyBhdHRyaWJ1dGUsIGNsYWltLCBpZGVudGl0eSAtPgogICAgdXNlclByb2ZpbGVWYWx1ZSA9IGZyb21TZXQoY2xhaW0uZ2V0TmFtZSgpLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSkKICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICE9IG51bGwpIHsKICAgICAgICBsb2NhbGVWYWx1ZXMgPSBwYXJzZUxvY2FsZUF3YXJlU3RyaW5nKHVzZXJQcm9maWxlVmFsdWUpCiAgICAgICAgbG9jYWxlID0gY2xhaW1zTG9jYWxlcy5maW5kIHsgbG9jYWxlIC0+IGxvY2FsZVZhbHVlcy5jb250YWluc0tleShsb2NhbGUpIH0KICAgICAgICBpZiAobG9jYWxlICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIFsoY2xhaW0uZ2V0TmFtZSgpKTogbG9jYWxlVmFsdWVzLmdldChsb2NhbGUpXQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBbOl0KfQoKLyoKICogQ2xhaW0gcmVzb2x2ZXIgd2hpY2ggZXhwZWN0cyB0aGUgdXNlcidzIHByb2ZpbGUgYXR0cmlidXRlIHZhbHVlIHRvIGJlIGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OgogKiAibGFuZ3VhZ2VfdGFnfHZhbHVlX2Zvcl9sYW5ndWFnZSwuLi4iLgogKgogKiBUaGlzIHJlc29sdmVyIHdpbGwgdGFrZSB0aGUgbGFuZ3VhZ2UgdGFnIHNwZWNpZmllZCBpbiB0aGUgY2xhaW0gb2JqZWN0IGFuZCBhdHRlbXB0IHRvIG1hdGNoIGl0IHRvIGEgdmFsdWUKICogZnJvbSB0aGUgdXNlcnMnIHByb2ZpbGUgYXR0cmlidXRlLiBJZiBubyBtYXRjaCBpcyBmb3VuZCBhbiBleGNlcHRpb24gaXMgdGhyb3duLgogKi8KbGFuZ3VhZ2VUYWdDbGFpbVJlc29sdmVyID0geyBhdHRyaWJ1dGUsIGNsYWltLCBpZGVudGl0eSAtPgogICAgdXNlclByb2ZpbGVWYWx1ZSA9IGZyb21TZXQoY2xhaW0uZ2V0TmFtZSgpLCBpZGVudGl0eS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSkKICAgIGlmICh1c2VyUHJvZmlsZVZhbHVlICE9IG51bGwpIHsKICAgICAgICBsb2NhbGVWYWx1ZXMgPSBwYXJzZUxvY2FsZUF3YXJlU3RyaW5nKHVzZXJQcm9maWxlVmFsdWUpCiAgICAgICAgaWYgKGNsYWltLmdldExvY2FsZSgpICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKGxvY2FsZVZhbHVlcy5jb250YWluc0tleShjbGFpbS5nZXRMb2NhbGUoKSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbKGNsYWltLmdldE5hbWUoKSk6IGxvY2FsZVZhbHVlcy5nZXQoY2xhaW0uZ2V0TG9jYWxlKCkpXQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW50cnkgPSBsb2NhbGVWYWx1ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpLm5leHQoKQogICAgICAgICAgICAgICAgcmV0dXJuIFsoY2xhaW0uZ2V0TmFtZSgpICsgIiMiICsgZW50cnkuZ2V0S2V5KCkpOiBlbnRyeS5nZXRWYWx1ZSgpXQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZW50cnkgPSBsb2NhbGVWYWx1ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpLm5leHQoKQogICAgICAgICAgICByZXR1cm4gWyhjbGFpbS5nZXROYW1lKCkpOiBlbnRyeS5nZXRWYWx1ZSgpXQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBbOl0KfQoKLyoKICogR2l2ZW4gYSBzdHJpbmcgImVufEVuZ2xpc2gsanB8SmFwZW5lc2UsZnJfQ0F8RnJlbmNoIENhbmFkaWFuIiB3aWxsIHJldHVybiBtYXAgb2YgbG9jYWxlIC0+IHZhbHVlLgogKi8KcGFyc2VMb2NhbGVBd2FyZVN0cmluZyA9IHsgcyAtPgogICAgcmV0dXJuIHJlc3VsdCA9IHMuc3BsaXQoIiwiKS5jb2xsZWN0RW50cmllcyB7IGVudHJ5IC0+CiAgICAgICAgc3BsaXQgPSBlbnRyeS5zcGxpdCgiXFx8IikKICAgICAgICBbKHNwbGl0WzBdKTogdmFsdWUgPSBzcGxpdFsxXV0KICAgIH0KfQovLyAtLS1eXl5eXl5eXl5eLS0tIEVYQU1QTEUgQ0xBSU0gQVRUUklCVVRFIFJFU09MVkVSIEZVTkNUSU9OUyAtLS1eXl5eXl5eXl5eLS0tCgovLyAtLS0tLS0tLS0tLS0tLSBVUERBVEUgVEhJUyBUTyBDSEFOR0UgQ0xBSU0gVE8gQVRUUklCVVRFIE1BUFBJTkcgRlVOQ1RJT05TIC0tLS0tLS0tLS0tLS0tLQovKgogKiBMaXN0IG9mIGNsYWltIHJlc29sdmVyIG1hcHBpbmdzLgogKi8KLy8gWyB7Y2xhaW19OiB7YXR0cmlidXRlIHJldHJpZXZlcn0sIC4uLiBdCmNsYWltQXR0cmlidXRlcyA9IFsKICAgICAgICAiYWRkcmVzcyI6IGFkZHJlc3NSZXNvbHZlci5jdXJyeSgiZnItaWRtLWFkZHJlc3NlcyIpLAogICAgICAgICJiaXJ0aGRhdGUiOiBiYXNpY1Jlc29sdmVyLmN1cnJ5KCJmci1pZG0tYmlydGhkYXRlIiksCiAgICAgICAgImVtYWlsIjogYXR0cmlidXRlUmVzb2x2ZXIuY3VycnkoImZyLWlkbS1lbWFpbHMiLCAidmFsdWUiLCB0cnVlLCB0cnVlKSwKICAgICAgICAiZ2VuZGVyIjogYmFzaWNSZXNvbHZlci5jdXJyeSgiZnItaWRtLWdlbmRlciIpLAogICAgICAgICJsb2NhbGUiOiBiYXNpY1Jlc29sdmVyLmN1cnJ5KCJmci1pZG0tbG9jYWxlIiksCiAgICAgICAgIm5hbWUiOiBuYW1lUmVzb2x2ZXIuY3VycnkoImZyLWlkbS1uYW1lLW9iamVjdCIpLAogICAgICAgICJuaWNrbmFtZSI6IGJhc2ljUmVzb2x2ZXIuY3VycnkoImZyLWlkbS1uaWNrLW5hbWUiKSwKICAgICAgICAicGhvbmUiOiBhdHRyaWJ1dGVSZXNvbHZlci5jdXJyeSgiZnItaWRtLXBob25lLW51bWJlcnMiLCAidmFsdWUiLCB0cnVlLCBmYWxzZSksCiAgICAgICAgInBpY3R1cmUiOiBhdHRyaWJ1dGVSZXNvbHZlci5jdXJyeSgiZnItaWRtLXBob3RvcyIsICJ2YWx1ZSIsIHRydWUsIGZhbHNlKSwKICAgICAgICAicHJlZmVycmVkX3VzZXJuYW1lIjogYmFzaWNSZXNvbHZlci5jdXJyeSgidXNlck5hbWUiKSwKICAgICAgICAicHJvZmlsZSI6IGJhc2ljUmVzb2x2ZXIuY3VycnkoImZyLWlkbS1wcm9maWxlLXVybCIpLAogICAgICAgICJ0aXRsZSI6IGJhc2ljUmVzb2x2ZXIuY3VycnkoImZyLWlkbS10aXRsZSIpLAogICAgICAgICJ1cGRhdGVkX2F0IjogZGF0ZVJlc29sdmVyLmN1cnJ5KCJtb2RpZnlUaW1lc3RhbXAiKSwKICAgICAgICAidXNlcm5hbWUiOiBiYXNpY1Jlc29sdmVyLmN1cnJ5KCJ1c2VyTmFtZSIpLAogICAgICAgICJ3ZWJzaXRlIjogYmFzaWNSZXNvbHZlci5jdXJyeSgiZnItaWRtLXdlYnNpdGUiKSwKICAgICAgICAiem9uZWluZm8iOiBiYXNpY1Jlc29sdmVyLmN1cnJ5KCJmci1pZG0tdGltZXpvbmUiKSwKXQoKLy8gLS0tLS0tLS0tLS0tLS0gVVBEQVRFIFRISVMgVE8gQ0hBTkdFIFNDT1BFIFRPIENMQUlNIE1BUFBJTkdTIC0tLS0tLS0tLS0tLS0tCi8qCiAqIE1hcCBvZiBzY29wZXMgdG8gY2xhaW0gb2JqZWN0cy4KICovCi8vIHtzY29wZX06IFsge2NsYWltfSwgLi4uIF0KLy8gaHR0cHM6Ly90cmVsbG8uY29tL2Mvd0hBM2VicDEvMTAyMS1pZC10b2tlbi1hbmQtdXNlcmluZm8tZW5kcG9pbnQtbm90LXJldHVybmluZy1hbGwtdXNlci1kYXRhCnNjb3BlQ2xhaW1zTWFwID0gWwogICAgICAgICJlbWFpbCI6IFsgImVtYWlsIiBdLAogICAgICAgICJhZGRyZXNzIjogWyAiYWRkcmVzcyIgXSwKICAgICAgICAicGhvbmUiOiBbICJwaG9uZSIgXSwKICAgICAgICAicHJvZmlsZSI6IFsKICAgICAgICAgICAgImJpcnRoZGF0ZSIsCiAgICAgICAgICAgICJmYW1pbHlfbmFtZSIsCiAgICAgICAgICAgICJnZW5kZXIiLAogICAgICAgICAgICAiZ2l2ZW5fbmFtZSIsCiAgICAgICAgICAgICJsb2NhbGUiLAogICAgICAgICAgICAibmFtZSIsCiAgICAgICAgICAgICJuaWNrbmFtZSIsCiAgICAgICAgICAgICJwaWN0dXJlIiwKICAgICAgICAgICAgInByZWZlcnJlZF91c2VybmFtZSIsCiAgICAgICAgICAgICJwcm9maWxlIiwKICAgICAgICAgICAgInRpdGxlIiwKICAgICAgICAgICAgInVwZGF0ZWRfYXQiLAogICAgICAgICAgICAidXNlcm5hbWUiLAogICAgICAgICAgICAid2Vic2l0ZSIsCiAgICAgICAgICAgICJ6b25laW5mbyIsCiAgICAgICAgXQpdCgovLyAtLS0tLS0tLS0tLS0tLS0tIFVQREFURSBCRUxPVyBGT1IgQURWQU5DRUQgVVNBR0VTIC0tLS0tLS0tLS0tLS0tLS0tLS0KaWYgKGxvZ2dlci5tZXNzYWdlRW5hYmxlZCgpKSB7CiAgICBzY29wZXMuZmluZEFsbCB7IHMgLT4gISgib3BlbmlkIi5lcXVhbHMocykgfHwgc2NvcGVDbGFpbXNNYXAuY29udGFpbnNLZXkocykpIH0uZWFjaCB7IHMgLT4KICAgICAgICBsb2dnZXIubWVzc2FnZSgiT3BlbkFNU2NvcGVWYWxpZGF0b3IuZ2V0VXNlckluZm8oKTo6TWVzc2FnZTogc2NvcGUgbm90IGJvdW5kIHRvIGNsYWltczogJHMiKQogICAgfQp9CgovKgogKiBDb21wdXRlcyB0aGUgY2xhaW1zIHJldHVybiBrZXkgYW5kIHZhbHVlLiBUaGUga2V5IG1heSBiZSBhIGRpZmZlcmVudCB2YWx1ZSBpZiB0aGUgY2xhaW0gdmFsdWUgaXMgbm90IGluCiAqIHRoZSByZXF1ZXN0ZWQgbGFuZ3VhZ2UuCiAqLwpkZWYgY29tcHV0ZUNsYWltID0geyBjbGFpbSAtPgogICAgdHJ5IHsKICAgICAgICBjbGFpbVJlc29sdmVyID0gY2xhaW1BdHRyaWJ1dGVzLmdldChjbGFpbS5nZXROYW1lKCksIHsgY2xhaW1PYmosIGlkZW50aXR5IC0+IGRlZmF1bHRDbGFpbVJlc29sdmVyKGNsYWltKX0pCiAgICAgICAgY2xhaW1SZXNvbHZlcihjbGFpbSwgaWRlbnRpdHkpCiAgICB9IGNhdGNoIChJZFJlcG9FeGNlcHRpb24gZSkgewogICAgICAgIGlmIChsb2dnZXIud2FybmluZ0VuYWJsZWQoKSkgewogICAgICAgICAgICBsb2dnZXIud2FybmluZygiT3BlbkFNU2NvcGVWYWxpZGF0b3IuZ2V0VXNlckluZm8oKTogVW5hYmxlIHRvIHJldHJpZXZlIGF0dHJpYnV0ZT0kYXR0cmlidXRlIiwgZSk7CiAgICAgICAgfQogICAgfSBjYXRjaCAoU1NPRXhjZXB0aW9uIGUpIHsKICAgICAgICBpZiAobG9nZ2VyLndhcm5pbmdFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoIk9wZW5BTVNjb3BlVmFsaWRhdG9yLmdldFVzZXJJbmZvKCk6IFVuYWJsZSB0byByZXRyaWV2ZSBhdHRyaWJ1dGU9JGF0dHJpYnV0ZSIsIGUpOwogICAgICAgIH0KICAgIH0KfQoKLyoKICogQ29udmVydHMgcmVxdWVzdGVkIHNjb3BlcyBpbnRvIGNsYWltIG9iamVjdHMgYmFzZWQgb24gdGhlIHNjb3BlIG1hcHBpbmdzIGluIHNjb3BlQ2xhaW1zTWFwLgogKi8KZGVmIGNvbnZlcnRTY29wZVRvQ2xhaW1zID0gewogICAgc2NvcGVzLmZpbmRBbGwgeyBzY29wZSAtPiAib3BlbmlkIiAhPSBzY29wZSAmJiBzY29wZUNsYWltc01hcC5jb250YWluc0tleShzY29wZSkgfS5jb2xsZWN0TWFueSB7IHNjb3BlIC0+CiAgICAgICAgc2NvcGVDbGFpbXNNYXAuZ2V0KHNjb3BlKS5jb2xsZWN0IHsgY2xhaW0gLT4KICAgICAgICAgICAgbmV3IENsYWltKGNsYWltKQogICAgICAgIH0KICAgIH0KfQoKLy8gQ3JlYXRlcyBhIGZ1bGwgbGlzdCBvZiBjbGFpbXMgdG8gcmVzb2x2ZSBmcm9tIHJlcXVlc3RlZCBzY29wZXMsIGNsYWltcyBwcm92aWRlZCBieSBBUyBhbmQgcmVxdWVzdGVkIGNsYWltcwpkZWYgY2xhaW1zVG9SZXNvbHZlID0gY29udmVydFNjb3BlVG9DbGFpbXMoKSArIGNsYWltT2JqZWN0cyArIHJlcXVlc3RlZFR5cGVkQ2xhaW1zCgovLyBDb21wdXRlcyB0aGUgY2xhaW0gcmV0dXJuIGtleSBhbmQgdmFsdWVzIGZvciBhbGwgcmVxdWVzdGVkIGNsYWltcwpjb21wdXRlZENsYWltcyA9IGNsYWltc1RvUmVzb2x2ZS5jb2xsZWN0RW50cmllcygpIHsgY2xhaW0gLT4KICAgIGNvbXB1dGVDbGFpbShjbGFpbSkKfQoKLy8gQ29tcHV0ZXMgY29tcG9zaXRlIHNjb3BlcwpkZWYgY29tcG9zaXRlU2NvcGVzID0gc2NvcGVDbGFpbXNNYXAuZmluZEFsbCB7IHNjb3BlIC0+CiAgICBzY29wZXMuY29udGFpbnMoc2NvcGUua2V5KQp9Cgpjb21wdXRlZENsYWltcy5wdXQoInJlbGlkIiwgaWRlbnRpdHkuZ2V0QXR0cmlidXRlKCJzY2ItUmVsSUQiKVswXSkKY29tcHV0ZWRDbGFpbXMucHV0KCJlYmlkIiwgaWRlbnRpdHkuZ2V0QXR0cmlidXRlKCJzY2ItRUJJRCIpWzBdKQpTdHJpbmcgbGFzdExvZ2luVGltZSA9IGlkZW50aXR5LmdldEF0dHJpYnV0ZSgic2NiLWxhc3RMb2dpblRpbWUiKVswXQppZiAoT2JqZWN0cy5pc051bGwobGFzdExvZ2luVGltZSkpewogICAgY29tcHV0ZWRDbGFpbXNbJ2xhc3RMb2dpblRpbWUnXSA9ICIiCn1lbHNlewogICAgWm9uZWREYXRlVGltZSB6b25lZERhdGVUaW1lID0gWm9uZWREYXRlVGltZS5wYXJzZShsYXN0TG9naW5UaW1lLCBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXktTU0tZGQnVCdISDptbTpzc1oiKSkKICAgIGxvbmcgdGltZUluTWlsbGlTZWMgPSB6b25lZERhdGVUaW1lLnRvSW5zdGFudCgpLnRvRXBvY2hNaWxsaSgpCiAgICBjb21wdXRlZENsYWltc1snbGFzdExvZ2luVGltZSddID0gdGltZUluTWlsbGlTZWMKfQoKcmV0dXJuIG5ldyBVc2VySW5mb0NsYWltcygoTWFwKWNvbXB1dGVkQ2xhaW1zLCAoTWFwKWNvbXBvc2l0ZVNjb3Blcyk=","default":true,"language":"GROOVY","context":"OIDC_CLAIMS","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id cd8cdad5-8245-447f-a264-32c9c2c591a4 --body '{"name":"mock create new user","description":null,"script":"dmFyIHZhbElkID0gInVzZXJuYW1lIjsKdmFyIG91dGNvbWVNYXBwaW5nID0gWyJyZWdpc3RlcmVkIiwgImZhaWxlZCJdOwp2YXIgZGVmYXVsdE91dGNvbWUgPSAic3VjY2VzcyI7Cgp2YXIgc3RhdGVWYWwgPSBzaGFyZWRTdGF0ZS5nZXQodmFsSWQpOwpvdXRjb21lID0gb3V0Y29tZU1hcHBpbmcuZmluZCgoYSkgPT4gc3RhdGVWYWwuaW5jbHVkZXMoYSkpOwpvdXRjb21lID0gb3V0Y29tZSA/IG91dGNvbWUgOiBkZWZhdWx0T3V0Y29tZTs=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id 357b1c94-91a3-4e3e-ab22-700b553b21a5 --body '{"name":"mock username uniqueness check","description":null,"script":"dmFyIHZhbElkID0gInVzZXJuYW1lIgp2YXIgb3V0Y29tZU1hcHBpbmcgPSBbImR1cCJdCnZhciBkZWZhdWx0T3V0Y29tZSA9ICJ1bmlxdWUiCgp2YXIgc3RhdGVWYWwgPSBzaGFyZWRTdGF0ZS5nZXQodmFsSWQpOwpvdXRjb21lID0gb3V0Y29tZU1hcHBpbmcuZmluZCgoYSkgPT4gc3RhdGVWYWwuaW5jbHVkZXMoYSkpOwpvdXRjb21lID0gb3V0Y29tZSA/IG91dGNvbWUgOiBkZWZhdWx0T3V0Y29tZTs=","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
create Scripts --realm sg-external --id af777e2f-4c6f-4d5f-b4b2-f2cafae2011e --body '{"name":"mock verify temp credentials","description":null,"script":"dmFyIHZhbElkID0gInRlbXBJZCIKdmFyIG91dGNvbWVNYXBwaW5nID0gWyJleHBpcmVkIiwgImludmFsaWQiLCAibG9ja2VkIiwgInJlZ2lzdGVyZWQiLCAiZmFpbGVkIl0KdmFyIGRlZmF1bHRPdXRjb21lID0gInN1Y2Nlc3MiCgp2YXIgc3RhdGVWYWwgPSBzaGFyZWRTdGF0ZS5nZXQodmFsSWQpOwpvdXRjb21lID0gb3V0Y29tZU1hcHBpbmcuZmluZCgoYSkgPT4gc3RhdGVWYWwuaW5jbHVkZXMoYSkpCm91dGNvbWUgPSBvdXRjb21lID8gb3V0Y29tZSA6IGRlZmF1bHRPdXRjb21lOw==","default":false,"language":"JAVASCRIPT","context":"AUTHENTICATION_TREE_DECISION_NODE","createdBy":"null","creationDate":0,"lastModifiedBy":"null","lastModifiedDate":0}'
